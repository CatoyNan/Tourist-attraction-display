<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="js/hammer.min.js"></script>
    <title>Document</title>
    <style>
        /* 初始化开始 */
        * {
            margin: 0;
            padding: 0;
        }
        body {
            /* background: url(images/bg_small.png); */
        }
        html,body{
          overflow: hidden;
          height: 100%;
        }
        img {
            /* pointer-events: none;  */
        }
        /* 地图界面开始 */
        #outer {
            width: 100%;
            height: 100%;
            margin:0 auto;
            position: relative;
            overflow: hidden;
        }
        #map {
            width: 1680px;
            height: 764px;
            position: relative;
            background-image: url(images/map_small.png);
        }
        .coordinate {
            width: 50px;
            height: 50px;
            position: absolute;
            border:1px solid red;
            border-radius: 50%;
        }
        .coordinate:click {

        }
        /* 提示界面开始 */
        .click {
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            position: absolute;
            left: 0;
            top: 0;
            display: table-cell;display:-webkit-box;
	        display:-ms-flexbox;
	        display:flex-box;
	        display:flex;
	        -webkit-box-align:center;
	        -ms-flex-align:center;
	        align-items:center;
	        -webkit-box-pack:center;
	        -ms-flex-pack:center;
	        justify-content:center;
	        text-align:center;
        }
        .click img {
            /* margin-top: 50%; */
            width: 70%;
            animation: twinkling 600ms infinite;
            -webkit-animation: twinkling 600ms infinite;
        }
        .click p span {
            display: block;
        }
        .click span:nth-child(1) {
            color: rgb(255, 255, 255);
            font-size: 1em;
            letter-spacing: 5px;
        }
        .click span:nth-child(2) {
            color: rgb(255, 255, 255);
            font-size: 1em;
        }
        /* 简介界面开始 */
        .brief {
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            position: absolute;
            background-color: rgba(0, 0, 0, 0.4);
            display:-webkit-box;
            display:-ms-flexbox;
            display:none;
            -webkit-box-align:center;
            -ms-flex-align:center;
            align-items:center;
            -webkit-box-pack:center;
            -ms-flex-pack:center;
            justify-content:center;
            text-align:center;
        }
        .content {
            width: 75%;
            height: 65%;
        }
        .content .header {
            width: 100%;
            height: 40%;
            border-top-left-radius: 7px;
            border-top-right-radius: 7px;
            /* border:1px solid blue; */
            /* background: url(images/img1.jpg) */
            background:
                        no-repeat
                        scroll
                        center center/100% 100%;
        }
        #cancel {
            float: right;
            /* border: 1px solid red; */
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: -5px;
            margin-top: -5px;
            background: rgba(255, 255, 255, 0.6)
                        url(images/cancel.png)
                        no-repeat
                        scroll
                        center center/10px 10px;
        }
        .content .center {
            width: 100%;
            height: 53%;
            background-color: rgba(255, 255, 255, 0.8);
            padding: 5% 5%;
            box-sizing: border-box;
            font-size: 0.8em;
            letter-spacing: 1px;
            /* border:1px solid green; */
        }
        .title {
            width: 100%;
            text-align: right;
            font-weight: 800;
            float: right;
            margin-bottom: 10px;
        }
        .voice {
            width: 30%;
            height: 80%;
            float: left;
            /* border:1px solid red; */
        }
        .voice img {
            width:50px;
            height:50px;
        }
        .voice img:active{
            width: 45px;
            height: 45px;
        }
        .article {
            width: 65%;
            height: 80%;
            float: right;
            padding: 2px 2px;
            box-sizing: border-box;
            background-color: rgba(240, 236, 241, .7);
            /* border: 1px solid blue; */
        }
        .text {
            height:75%;
            width: 90%;
            margin: 5px auto;
            overflow-x:hidden;
            overflow-y:scroll;
            /* border: 1px solid red; */
        }
        .text p {
            padding: 0 4px 0 7px;
            line-height: 1.5em;
            letter-spacing: 0.2em;
            font-size: 1em;
            text-align: left;
        }
        .content .footer {
            width: 100%;
            height: 7%;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.8em;
            letter-spacing: 1px;
            line-height: 6%;
            display: table;
            /* border:1px solid white; */
            border-bottom-left-radius: 7px;
            border-bottom-right-radius: 7px;
            background-color: rgba(0, 0, 0, 0.4);
        }
        .footer a {
            list-style: none;
            vertical-align:middle;
            display:table-cell;
        }
        /* 手指闪烁动画开始 */
        @-webkit-keyframes twinkling{	/*透明度由0到1*/
            0%{
                opacity:0.1;				/*透明度为0*/
            }
            50%{
                opacity:1;				/*透明度为0*/
            }
            100%{
                opacity:0.1;				/*透明度为1*/
            }

        }
        @keyframes twinkling{	/*透明度由0到1*/
            0%{
                opacity:0.1;				/*透明度为0*/
            }
            50%{
                opacity:1;				/*透明度为0*/
            }
            100%{
                opacity:0.1;				/*透明度为1*/
            }
        }
        /* 渐现、渐隐动画 */
        @keyframes show{
            0%{
                opacity:0;
            }
            100%{
                opacity:1;
            }
        }
        @keyframes disappear{
            0%{
                opacity:1;
            }
            100%{
                opacity:0;
            }
        }

    </style>
</head>
<body>
    <!-- 地图界面开始 -->
    <div id="outer">
        <div id="map">
            <div id="亚洲大象" class="coordinate" style="top:150px;left:90px;"></div>
            <div id="测试" class="coordinate" style="top:250px;left:90px;"></div>
            <!-- <div class="coordinate" style="top:350px;left:90px;"></div>
            <div class="coordinate" style="top:50px;left:190px;"></div>
            <div class="coordinate" style="top:50px;left:890px;"></div>
            <div class="coordinate" style="top:50px;left:990px;"></div> -->
        </div>
    </div>
    <!-- 提示界面开始 -->
    <div id="click_bg" class="click">
        <div>
            <img src="images/point.png" alt="" id="click_img">
            <p><span>点击景点</span><span>收听语音简介</span></p>
        </div>
    </div>
    <!-- 简介界面开始 -->
    <div id="brief" class="brief">
            <div class="content">
                <div id="header" class="header">
                    <div id="cancel"></div>
                </div>
                <div class="center">
                    <div class="title">亚洲大象</div>
                    <div style="height:100%;width:100%;">
                        <div class="voice">
                            <img id="playIcon" src="images/playIcon.png" alt="">
                        </div>
                        <div class="article">
                            <div><span>---</span>景点简介<span>---</span></div>
                            <div id="ar" class="text">
                                <p id="text"></p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="footer">
                    <a>更多景点导览</a>
                </div>
            </div>
    </div>

    <!-- 音乐 -->
    <audio id="music" src="music/music1.mp3" class="stop">
    </audio>

<!-- js -->
<script type="text/javascript">
    window.onload = function(){
        var oMap = document.getElementById("map");
        var oCoordinates = oMap.getElementsByTagName("div");
        var oOuter = document.getElementById("outer");
        var oBrief = document.getElementById("brief");
        var oHeader = document.getElementById("header");
        var oText = document.getElementById("text");
        var oAr = document.getElementById("ar");
        var oCancel = document.getElementById("cancel");
        var oPlayIcon = document.getElementById("playIcon");
        var oPlayIcon2 = document.getElementById("playIcon");
        var mapWidth = oMap.offsetWidth;
        var mapHeight = oMap.offsetHeight;
        var windowWidth = document.body.clientWidth;
        var windowHeight = document.body.clientHeight;
        var objs = new Array();
        objs["亚洲大象"] = {
            img: "images/img1.jpg",
            title: "亚洲大象",
            voice: "music/music1.mp3",
            text: "哈哈哈哈哈哈哈哈哈哈啊哈随碟附送砥砺奋进拉萨的几分拉就死定了房间爱乐山大佛零售价地方了几声两地分居拉萨的菲拉斯惊呆了房价阿斯兰的房间拉三等奖飞哈哈哈哈哈哈哈哈哈啊哈哈哈发货拉萨地方了将阿里山的房间阿萨德飞加拉斯金东方辣椒水地方了将阿里山的房间jjf"
        };
        objs["测试"] = {
            img: "images/img0.jpg",
            title: "测试",
            voice: "music/music1.mp3",
            text: "类似绝地了房价阿斯兰的就废了了房价阿斯兰的肌肤拉斯金东方乐尽哀生两地分居拉三等奖放辣椒水砥砺奋进阿斯兰的房间爱拉三等奖法拉绝对是发垃圾堆放辣椒水砥砺奋进阿里山的肌肤拉三等奖飞拉丝机的放辣椒水砥砺奋进阿斯兰的房间爱拉三等奖分拉三等奖飞垃圾说德律风阿斯兰的房间拉萨的房间"
        };
        drag(oMap);
        showBrief();
        briefDisappear();
        playMusic();
        // 获取css相关属性
         function getCss(o,key){
           return o.currentStyle? o.currentStyle[key] : document.defaultView.getComputedStyle(o,false)[key];
         };

       // 地图拖动函数
        function drag(element){
            element.style.top = getCss(element,"top");
            element.style.left = getCss(element,"left");
            var hammer = new Hammer(element);//hammer实例
            hammer.get('pan').set({ direction: Hammer.DIRECTION_ALL });//允许垂直拖动
            var x = 0;
            var y = 0;
            hammer.on('panstart',function(event){
                x = parseInt(element.style.left);
                y = parseInt(element.style.top);
                console.log(x);
            });
            hammer.on('panmove',function(event){
                element.style.top = y + event.deltaY + "px";
                element.style.left = x + event.deltaX + "px";
                console.log('top'+element.style.top+'/left'+element.style.left);
            });
            hammer.on('panend',function(event){
                reset(element);
            });
            // hammer.on('tap',function(){
            //     alert(123);
            // });
        }
        // 点击显示简介
        function showBrief(){
            for(i=0;i<oCoordinates.length;i++){
                var hammer = new Hammer(oCoordinates[i]);
                hammer.on('tap',function(event){
                    oHeader.style.backgroundImage = "url('"+objs[event.target.id].img+"')";
                    oText.innerHTML = objs[event.target.id].text;
                    // alert(event.target);
                    // alert(objs[event.target.id].img);
                    // alert(objs[0].img);
                    oBrief.style.display = "flex";
                    oBrief.style.animation = "show 0.8s";
                });
            }
        }
        // 简介消失
        function briefDisappear(){
            var hammer = new Hammer(oCancel);
            hammer.on('tap',function(event){
                if(oBrief.style.display != "none"){
                    oBrief.style.animation = "disappear 0.5s";
                    setTimeout(function(){
                        oBrief.style.display = "none";
                    },"400");
                }
                if(music.status='play'){
                    music.pause();
                }
                // setTimeout(function(){
                //     oAr.scrollTop = 0;
                // },"300");
                 oAr.scrollTop = 0;
            })
        }
        // 超出边界退回
        function reset(element){
            if(parseInt(element.style.top)>0){
                element.style.top=0;
            }
            if(parseInt(element.style.left)>0){
                element.style.left=0;
            }
            if(mapWidth-windowWidth>0 & parseInt(element.style.left)<0 & Math.abs(parseInt(element.style.left))>(mapWidth-windowWidth)){
                element.style.left=-(mapWidth-windowWidth)+"px";
            }
            if(mapWidth-windowWidth<0 & parseInt(element.style.left)<0){
                element.style.left=0;
            }
            if(mapHeight-windowHeight>0 & parseInt(element.style.top)<0 & Math.abs(parseInt(element.style.top))>(mapHeight-windowHeight)){
                element.style.top=-(mapHeight-windowHeight)+"px";
            }
            if(mapHeight-windowHeight<0 & parseInt(element.style.top)<0){
                element.style.top=0;
            }
        }
        // 延时函数
        setTimeout(function timeout(){
            document.getElementById("click_bg").style.display = "none";
        },"3000");
        // 音乐播放按钮事件
        function playMusic(){
            hammer = new Hammer(oPlayIcon);
            var music = document.getElementById("music");
            hammer.on('tap',function(){
                if(music.paused){
                    music.play();
                }
                else if(music.status='play'){
                    music.pause();
                }
            });
        }
        // 增加景点坐标函数
        // function addPlace(p_x,p_y){
        //     html =  oOuter.innerHTML;
        //     // alert(oOuter.innerHTML);
        //     // oOuter.innerHTML = html + "<div style='top="+p_y+"px;left="+p_x+"px;'></div>";
        //     oOuter.innerHTML = html + "<div></div>";
        //     var oDiv = oOuter.getElementsByTagName("div");
        //     oDiv[oDiv.length-1].className = "coordinate";
        //     oDiv[oDiv.length-1].style.top = p_y+"px";
        //     oDiv[oDiv.length-1].style.left = p_x+"px";
        // }
    }
</script>
</body>
</html>
